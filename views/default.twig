<script>
const width = window.innerWidth;
const height = window.innerHeight;
const centerY = height / 2;
const amplitude = height * 0.1;
const speed = 150;
const degrees = 45;

let startTime = 0;
let previousTime = 0;
let pausedTime = 0;
let paused = false;
let canvas, ctx;
let charObjs;

const init = () => {
  canvas = document.createElement('canvas');
  canvas.width = width;
  canvas.height = height;
  ctx = canvas.getContext('2d');

  document.body.appendChild(canvas);
  window.addEventListener('blur', () => {
    if (!paused) {
      paused = true;
      pausedTime = Date.now() - startTime;
    } 
  });
  window.addEventListener('focus', () => {
    if (paused) {
      paused = false;
      startTime = Date.now() - pausedTime;
      animate();
    } 
  });
 
  charObjs = initScrollText('GREETZ FROM FOXVERSE TEAM, EXCITEMENT AWAITS YOU FROM A PLACE FAR AWAY');
  
  startTime = Date.now();
  previousTime = getTime();
  animate();
};

const initScrollText = (text) => {
  ctx.font = 'bold 32px Courier New';
  
  let position = 0;
  
  return text.split('').map((char) => {
    const width = ctx.measureText(char).width;
    const charObj = {
      char,
      width,
      position
    };
    
    position += width;
    return charObj;
  });
};

const getTime = () => {
  return paused 
       ? pausedTime 
       : Date.now() - startTime;
};

const scrollText = (dt) => {
  ctx.fillStyle = 'white';
  
  charObjs.forEach((charObj) => {
    charObj.position += dt * speed;
    
    if (charObj.position > width) {
      charObj.position = -charObj.width;
    }
    
    const y = Math.sin(charObj.position / degrees) * amplitude;
    
    ctx.fillText(charObj.char, charObj.position, centerY + y);
  }); 
};

const animate = () => {
  const now = getTime();
  const dt = (now - previousTime) * 0.001 // delta time in seconds.
  previousTime = now;
  
  ctx.fillStyle = 'black';
  ctx.fillRect(0, 0, width, height);
  
  scrollText(dt);
  
  if (!paused) {
    requestAnimationFrame(animate);
  }
};

init();
</script>
<style>
html, body {
  margin: 0;
  padding: 0;
}

canvas {
  position: absolute;
  margin: auto;
  top: 0; left: 0; bottom: 0; right: 0;
}
audio { 
   display:none;
}
</style>
<audio loop autoplay="true" src="/knas.mp3">